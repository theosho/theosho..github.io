(function(c,b){var a={};c.contextmenu={object:c("<ul id='js-contextmenu' class='js-context' />"),settings:false,args:false,defaults:{class_name:"hover",items:{}},selector:"",init:function(d,e){c(document).on("contextmenu",d,function(f){c.contextmenu.settings=c.extend(true,{},e);c.contextmenu.selector=d;c.contextmenu.show(f,this)})},show:function(u,m){if(!c.contextmenu.args){c.contextmenu.args=[m,u]}var g=c.extend(true,{},c.contextmenu.defaults,c.contextmenu.settings);c.contextmenu.object.empty();var v="";var n=0;var A=true;for(var s in g.items){if(!g.items.hasOwnProperty(s)){continue}if(g.items[s]===false){continue}var l=1;if(typeof g.items[s].visible=="function"){l=g.items[s].visible.apply(null,c.contextmenu.args)}if(typeof(l)=="object"&&(l instanceof Array)){g.items[s].icon=l[1];l=l[0]}if(l==-1){continue}else{n++}v+='<li class="'+g.items[s].icon;if(l==0){v+=" disabled"}if((l!=0)&&A){A=false;v+=" first"}if(g.items[s].children){v+=" parent"}v+='"><a href="#" rel="'+s+'" class="'+s+" "+(l==0?"disabled":"")+'">';v+="<span>"+g.items[s].label+"</span></a>";if(g.items[s].children){v+="<ul>";for(var q in g.items[s].children){var f=1;if(typeof g.items[s].children[q].visible=="function"){f=g.items[s].children[q].visible.apply(null,c.contextmenu.args)}v+='<li class="'+g.items[s].children[q].icon;if(g.items[s].children[q].children){v+=" parent"}if(f==0){v+=" disabled"}v+='"><a href="#" rel="'+s+"_c_h_i_l_d_"+q+'" class="'+q+" "+(l==0?"disabled":"")+'">';v+="<span>"+g.items[s].children[q].label+"</span></a>";if(g.items[s].children[q].children){v+="<ul>";for(var p in g.items[s].children[q].children){var f=1;if(typeof g.items[s].children[q].children[p].visible=="function"){f=g.items[s].children[q].children[p].visible.apply(null,c.contextmenu.args)}v+='<li class="'+g.items[s].children[q].children[p].icon;if(f==0){v+=" disabled"}v+='"><a href="#" rel="'+s+"_s_u_b_c_h_i_l_d_"+q+"_s_u_b_c_h_i_l_d_"+p+'" class="'+p+" "+(l==0?"disabled":"")+'">';v+="<span>"+g.items[s].children[q].children[p].label+"</span></a></li>"}v+="</ul>"}v+="</li>"}v+="</ul>"}v+="</li>"}v+='<li class="brdr"></li>';c.contextmenu.object.attr("class","js-context").html(v);var t=c.contextmenu.object.height();var C=c.contextmenu.object.width();var B=u.clientX;var z=u.clientY+c(b).scrollTop();var D=c(b).height()+c(b).scrollTop();var d=c(b).width()+c(b).scrollLeft();if(z+t>D){z=Math.max((D-t-2),0)}if(B+C>d){B=Math.max((d-C-2),0)}c.contextmenu.object.css({left:(B),top:(z)}).fadeIn("fast");c(document).on("keyup.contextmenu",function(e){c.contextmenu.hide()});u.preventDefault();u.stopPropagation()},hide:function(){if(c.contextmenu.settings){c(document).off("keyup.contextmenu")}c.contextmenu.settings=false;c.contextmenu.args=false;c.contextmenu.object.fadeOut("fast")},exec:function(g){if(g.toLowerCase().indexOf("_s_u_b_c_h_i_l_d_")!=-1){var d=g.split("_s_u_b_c_h_i_l_d_",3);var f=c.extend(true,{},c.contextmenu.defaults,c.contextmenu.settings);try{f.items[d[0]].children[d[1]].children[d[2]].action.apply(null,c.contextmenu.args)}catch(h){}}else{if(g.toLowerCase().indexOf("_c_h_i_l_d_")!=-1){var d=g.split("_c_h_i_l_d_",2);var f=c.extend(true,{},c.contextmenu.defaults,c.contextmenu.settings);try{f.items[d[0]].children[d[1]].action.apply(null,c.contextmenu.args)}catch(h){}}else{var f=c.extend(true,{},c.contextmenu.defaults,c.contextmenu.settings);try{f.items[g].action.apply(null,c.contextmenu.args)}catch(h){}}}}};c(function(){c.contextmenu.object.appendTo("body");c("#js-contextmenu").on("click","a",function(d){d.stopPropagation();d.preventDefault();return false}).on("mousedown","a",function(d){if(!c(this).hasClass("disabled")){c.contextmenu.exec.apply(null,[c(this).attr("rel")])}}).on("mouseover","li",function(d){c(this).addClass("hover");c(this).hover(function(){},function(){c(this).removeClass("hover")})});c(document).on("mousedown.contextmenu",function(d){if(d.which!=3||c(d.target).closest(c.contextmenu.selector).size()==0){c.contextmenu.hide()}})})})(jQuery,this);